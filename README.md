# QS数据爬虫项目

## 项目简介

这是一个用于爬取QS世界大学排名数据和基金从业资格信息的Python项目。项目包含完整的日志记录和错误通知功能，确保数据爬取的可靠性和可监控性。

## 功能特性

### 核心功能
- 爬取QS世界大学排名数据
- 爬取基金从业资格信息
- 数据保存到Excel文件
- 数据保存到MySQL数据库
- 自动创建数据表结构

### 日志记录功能
- 详细的日志记录，包括INFO、WARNING、ERROR级别
- 日志同时输出到控制台和文件
- 日志文件按日期自动分割
- 日志文件保存在`logs`目录下

### 错误通知功能
- 自动捕获和记录所有异常
- 在终端显示详细的错误信息
- 记录错误堆栈跟踪到日志文件
- 简洁的错误通知机制

## 文件结构

```
QS/
├── QStop.py                 # QS大学排名爬虫程序
├── fund_crawler.py          # 基金从业资格爬虫程序
├── fund_crawler_demo.py     # 基金从业资格爬虫程序（演示模式）
├── requirements.txt          # 依赖包列表
├── README.md                # 项目说明文档
└── logs/                    # 日志文件目录
    ├── qs_crawler_20250101.log
    ├── fund_crawler_20250101.log
    ├── fund_crawler_demo_20250101.log
    └── ...
```

## 安装和配置

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置数据库
修改`QS_simple.py`中的数据库配置：
```python
DB_CONFIG = {
    'host': 'localhost',
    'user': 'your_username',
    'password': 'your_password',
    'database': 'qs',
    'port': 3306,
    'charset': 'utf8mb4'
}
```



## 使用方法

### 运行QS大学排名爬虫
```bash
python QStop.py
```

### 运行基金从业资格爬虫
```bash
python fund_crawler.py
```

### 运行基金从业资格爬虫（演示模式）
```bash
python fund_crawler_demo.py
```

### 查看日志
- 文件日志：查看`logs`目录下的日志文件
- 程序运行时不会在终端显示日志信息

### 日志级别说明
- **INFO**: 正常操作信息，如开始爬取、保存数据等
- **WARNING**: 警告信息，如数据解析失败但程序继续运行
- **ERROR**: 错误信息，如网络请求失败、数据库连接失败等

## 错误处理

### 自动重试机制
- 网络请求失败时自动重试
- 数据库连接失败时记录错误并通知
- 数据解析失败时跳过该条记录并继续

### 错误通知
当发生严重错误时，系统会：
1. 记录错误日志到文件
2. 保存错误堆栈跟踪
3. 所有错误信息都保存在日志文件中

## 日志文件说明

### 日志文件命名
- 格式：`qs_crawler_YYYYMMDD.log`
- 示例：`qs_crawler_20250101.log`

### 日志内容
- 时间戳
- 日志级别
- 详细消息
- 错误堆栈信息（如果有）

## 注意事项

1. **数据库连接**：确保MySQL服务正在运行，且配置信息正确
2. **网络连接**：程序需要访问互联网来爬取数据
3. **日志清理**：建议定期清理旧的日志文件以节省磁盘空间

## 故障排除

### 常见问题

1. **数据库连接失败**
   - 检查MySQL服务是否运行
   - 验证数据库配置信息
   - 查看日志文件中的详细错误信息

2. **网络请求失败**
   - 检查网络连接
   - 确认目标网站可访问
   - 查看日志中的具体错误信息



### 获取帮助
如果遇到问题，请：
1. 查看日志文件中的详细错误信息
2. 检查配置文件是否正确
3. 确认所有依赖包已正确安装

## 基金从业资格爬虫功能说明

### 数据字段
- **姓名**: 基金从业人员的姓名
- **性别**: 男/女
- **证书编号**: 基金从业资格证书编号
- **机构名称**: 所属基金公司或机构名称
- **从业资格类别**: 基金从业资格类型
- **证书取得日期**: 获得证书的日期
- **证书状态变更记录**: 证书状态变更次数
- **诚信记录**: 诚信记录数量
- **证书状态**: 证书当前状态（正常/异常等）
- **学历**: 教育背景

### 数据限制
- 最多爬取1000条记录
- 每天更新覆盖数据
- 自动去重处理

### 演示模式
由于API访问限制，提供了演示模式版本 `fund_crawler_demo.py`，使用模拟数据展示完整功能：
- 包含3条示例数据
- 完整的数据处理流程
- Excel和数据库保存功能
- 详细的日志记录

## 更新日志

### v1.2.0 (2025-01-05)
- 新增基金从业资格爬虫功能
- 支持基金从业人员信息爬取
- 新增基金从业资格数据表结构
- 完善项目文档

### v1.1.0 (2025-01-01)
- 新增完整的日志记录功能
- 新增终端错误通知功能
- 改进错误处理机制
- 添加详细的文档说明

### v1.0.0 (2024-12-01)
- 初始版本发布
- 基本的爬虫功能
- Excel和数据库保存功能 