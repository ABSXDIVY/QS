# åŸºé‡‘ä»ä¸šèµ„æ ¼çˆ¬è™«åçˆ¬ç»•è¿‡æˆåŠŸåˆ†æ

## ğŸ¯ é¡¹ç›®èƒŒæ™¯

ç›®æ ‡ç½‘ç«™ï¼š`https://gs.amac.org.cn/amac-infodisc/api/pof/person`
- è¿™æ˜¯ä¸€ä¸ªåŸºé‡‘ä»ä¸šèµ„æ ¼ä¿¡æ¯æŸ¥è¯¢API
- ç½‘ç«™é‡‡ç”¨äº†å¤šç§åçˆ¬æŠ€æœ¯
- éœ€è¦è·å–1000æ¡åŸºé‡‘ä»ä¸šäººå‘˜æ•°æ®

## ğŸ” åçˆ¬æŠ€æœ¯åˆ†æ

### 1. åŸºç¡€åçˆ¬æªæ–½
- **User-Agentæ£€æµ‹**ï¼šæ£€æŸ¥è¯·æ±‚å¤´ä¸­çš„æµè§ˆå™¨æ ‡è¯†
- **RefereréªŒè¯**ï¼šéªŒè¯è¯·æ±‚æ¥æºé¡µé¢
- **è¯·æ±‚é¢‘ç‡é™åˆ¶**ï¼šé™åˆ¶çŸ­æ—¶é—´å†…è¯·æ±‚æ¬¡æ•°
- **IPå°ç¦**ï¼šå¯¹å¼‚å¸¸IPè¿›è¡Œå°ç¦

### 2. é«˜çº§åçˆ¬æŠ€æœ¯
- **JavaScriptåŠ¨æ€åŠ è½½**ï¼šæ•°æ®é€šè¿‡AJAXåŠ¨æ€è·å–
- **POSTè¯·æ±‚éªŒè¯**ï¼šä½¿ç”¨POSTè€ŒéGETè¯·æ±‚
- **å‚æ•°åŠ å¯†**ï¼šuserIdç­‰å…³é”®å‚æ•°éœ€è¦æ­£ç¡®ä¼ é€’
- **ä¼šè¯éªŒè¯**ï¼šéœ€è¦æ­£ç¡®çš„ä¼šè¯çŠ¶æ€

## ğŸš€ åçˆ¬ç»•è¿‡ç­–ç•¥

### 1. è¯·æ±‚å¤´ä¼ªè£… âœ…
```python
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36',
    'Accept': 'application/json, text/javascript, */*; q=0.01',
    'Accept-Language': 'zh-CN,zh;q=0.9',
    'Content-Type': 'application/json',
    'Origin': 'https://gs.amac.org.cn',
    'Referer': 'https://gs.amac.org.cn/amac-infodisc/res/pof/person/personList.html?userId=1700000000699008',
    'X-Requested-With': 'XMLHttpRequest'
}
```

**æˆåŠŸåŸå› **ï¼š
- å®Œå…¨æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨è¯·æ±‚å¤´
- åŒ…å«æ‰€æœ‰å¿…è¦çš„è®¤è¯ä¿¡æ¯
- RefereråŒ…å«æ­£ç¡®çš„userIdå‚æ•°

### 2. è¯·æ±‚æ–¹æ³•é€‰æ‹© âœ…
```python
# ä½¿ç”¨POSTè¯·æ±‚è€ŒéGET
response = session.post(
    "https://gs.amac.org.cn/amac-infodisc/api/pof/person",
    params=params,
    json=json_data,
    timeout=30
)
```

**æˆåŠŸåŸå› **ï¼š
- ç½‘ç«™å®é™…ä½¿ç”¨POSTè¯·æ±‚è·å–æ•°æ®
- GETè¯·æ±‚ä¼šè¢«æ‹’ç»æˆ–è¿”å›é”™è¯¯æ•°æ®

### 3. å‚æ•°ä¼ é€’ç­–ç•¥ âœ…
```python
# URLå‚æ•° - æ§åˆ¶åˆ†é¡µ
params = {
    'rand': f"0.{random.randint(1000000000000000, 9999999999999999)}",
    'page': page,
    'size': page_size
}

# JSONæ•°æ® - å›ºå®šæ ¼å¼
json_data = {
    'userId': '1700000000699008',
    'page': 1  # å›ºå®šä¸º1ï¼Œåˆ†é¡µé€šè¿‡URLå‚æ•°æ§åˆ¶
}
```

**æˆåŠŸåŸå› **ï¼š
- åˆ†é¡µé€šè¿‡URLå‚æ•°æ§åˆ¶ï¼ŒJSONä¸­çš„pageå›ºå®šä¸º1
- userIdæ˜¯è®¤è¯çš„å…³é”®å‚æ•°
- éšæœºæ•°randé¿å…ç¼“å­˜

### 4. ä¼šè¯ç®¡ç† âœ…
```python
session = requests.Session()
session.verify = False
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
```

**æˆåŠŸåŸå› **ï¼š
- ä½¿ç”¨Sessionä¿æŒè¿æ¥çŠ¶æ€
- ç¦ç”¨SSLéªŒè¯é¿å…è¯ä¹¦é—®é¢˜

### 5. è¯·æ±‚é¢‘ç‡æ§åˆ¶ âœ…
```python
time.sleep(random.uniform(1, 2))  # éšæœºå»¶è¿Ÿ
```

**æˆåŠŸåŸå› **ï¼š
- é¿å…è¯·æ±‚è¿‡äºé¢‘ç¹è¢«æ£€æµ‹
- éšæœºå»¶è¿Ÿæ¨¡æ‹Ÿäººç±»è¡Œä¸º

## ğŸ¯ å…³é”®çªç ´ç‚¹

### 1. ä¿¡æ¯æ”¶é›†çš„é‡è¦æ€§
- **æµè§ˆå™¨å¼€å‘è€…å·¥å…·**ï¼šè·å–çœŸå®çš„è¯·æ±‚ä¿¡æ¯
- **cURLå‘½ä»¤å¤åˆ¶**ï¼šè·å¾—å®Œæ•´çš„è¯·æ±‚å¤´å’Œå‚æ•°
- **ç½‘ç»œè¯·æ±‚åˆ†æ**ï¼šç†è§£APIçš„å®é™…å·¥ä½œæ–¹å¼

### 2. ç»†èŠ‚å†³å®šæˆè´¥
- **Refererå¿…é¡»æ­£ç¡®**ï¼šåŒ…å«userIdå‚æ•°
- **Content-Typeè®¾ç½®**ï¼šå¿…é¡»æ˜¯application/json
- **åˆ†é¡µæœºåˆ¶ç†è§£**ï¼šURLå‚æ•°æ§åˆ¶åˆ†é¡µï¼ŒJSONå›ºå®š

### 3. è°ƒè¯•å’ŒéªŒè¯
- **é€æ­¥è°ƒè¯•**ï¼šä»ç®€å•åˆ°å¤æ‚
- **å¯¹æ¯”åˆ†æ**ï¼šæˆåŠŸvså¤±è´¥çš„è¯·æ±‚å·®å¼‚
- **æ—¥å¿—è®°å½•**ï¼šè¯¦ç»†è®°å½•æ¯ä¸ªæ­¥éª¤

## ğŸ“Š æˆåŠŸæ•°æ®å¯¹æ¯”

### å¤±è´¥å°è¯•
- GETè¯·æ±‚ï¼šè¿”å›500é”™è¯¯
- é”™è¯¯Refererï¼šè¿”å›ç©ºæ•°æ®
- é”™è¯¯userIdï¼šè®¤è¯å¤±è´¥
- é”™è¯¯åˆ†é¡µå‚æ•°ï¼šæ•°æ®å¼‚å¸¸

### æˆåŠŸæ–¹æ¡ˆ
- POSTè¯·æ±‚ï¼šè¿”å›200çŠ¶æ€ç 
- æ­£ç¡®Refererï¼šè·å–çœŸå®æ•°æ®
- æ­£ç¡®userIdï¼šè®¤è¯æˆåŠŸ
- æ­£ç¡®åˆ†é¡µï¼šè·å–1000æ¡æ•°æ®

## ğŸ”§ æŠ€æœ¯è¦ç‚¹æ€»ç»“

### 1. åçˆ¬ç»•è¿‡æ ¸å¿ƒ
```python
# å…³é”®æˆåŠŸè¦ç´ 
1. æ­£ç¡®çš„è¯·æ±‚æ–¹æ³• (POST)
2. å®Œæ•´çš„è¯·æ±‚å¤´ (æ¨¡æ‹Ÿæµè§ˆå™¨)
3. æ­£ç¡®çš„è®¤è¯å‚æ•° (userId)
4. åˆç†çš„è¯·æ±‚é¢‘ç‡ (éšæœºå»¶è¿Ÿ)
5. æ­£ç¡®çš„åˆ†é¡µæœºåˆ¶ (URLå‚æ•°æ§åˆ¶)
```

### 2. ä»£ç ä¼˜åŒ–ç­–ç•¥
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šåˆ†ç¦»çˆ¬å–ã€ä¿å­˜ã€æ—¥å¿—åŠŸèƒ½
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸æ•è·æœºåˆ¶
- **æ—¥å¿—è®°å½•**ï¼šè¯¦ç»†çš„æ“ä½œæ—¥å¿—
- **æ•°æ®éªŒè¯**ï¼šç¡®ä¿æ•°æ®å®Œæ•´æ€§

### 3. ç»´æŠ¤æ€§è€ƒè™‘
- **å®šæ—¶ä»»åŠ¡**ï¼šæ¯å¤©è‡ªåŠ¨æ‰§è¡Œ
- **æ•°æ®å»é‡**ï¼šä½¿ç”¨ON DUPLICATE KEY UPDATE
- **å†å²æ•°æ®**ï¼šExcelä¿å­˜å…¨éƒ¨ï¼Œæ•°æ®åº“ä¿å­˜æœ€æ–°
- **ç›‘æ§å‘Šè­¦**ï¼šæ—¥å¿—è®°å½•æ‰§è¡ŒçŠ¶æ€

## ğŸ’¡ ç»éªŒæ€»ç»“

### 1. åçˆ¬ç»•è¿‡åŸåˆ™
- **ä¿¡æ¯æ”¶é›†ç¬¬ä¸€**ï¼šå®Œæ•´è·å–çœŸå®è¯·æ±‚ä¿¡æ¯
- **ç»†èŠ‚å†³å®šæˆè´¥**ï¼šæ¯ä¸ªå‚æ•°éƒ½å¾ˆé‡è¦
- **é€æ­¥è°ƒè¯•**ï¼šä»ç®€å•åˆ°å¤æ‚é€æ­¥å®Œå–„
- **æŒç»­éªŒè¯**ï¼šç¡®ä¿è·å–çœŸå®æ•°æ®

### 2. æŠ€æœ¯é€‰å‹
- **requestsåº“**ï¼šç®€å•é«˜æ•ˆçš„HTTPè¯·æ±‚
- **pandas**ï¼šæ•°æ®å¤„ç†å’Œåˆ†æ
- **SQLAlchemy**ï¼šæ•°æ®åº“æ“ä½œ
- **schedule**ï¼šå®šæ—¶ä»»åŠ¡ç®¡ç†

### 3. é¡¹ç›®æ¶æ„
- **çˆ¬è™«æ¨¡å—**ï¼š`fund_crawler_post.py`
- **å®šæ—¶ä»»åŠ¡**ï¼š`fund_crawler_scheduler.py`
- **æ•°æ®å­˜å‚¨**ï¼šMySQL + Excel
- **æ—¥å¿—ç®¡ç†**ï¼šæŒ‰æ—¥æœŸåˆ†æ–‡ä»¶

## ğŸ‰ æœ€ç»ˆæˆæœ

- âœ… **æˆåŠŸç»•è¿‡åçˆ¬**ï¼šè·å–1000æ¡çœŸå®æ•°æ®
- âœ… **æ•°æ®å®Œæ•´æ€§**ï¼šåŒ…å«æ‰€æœ‰è¦æ±‚å­—æ®µ
- âœ… **è‡ªåŠ¨åŒ–è¿è¡Œ**ï¼šå®šæ—¶ä»»åŠ¡æ¯å¤©æ‰§è¡Œ
- âœ… **æ•°æ®æŒä¹…åŒ–**ï¼šExcelå’Œæ•°æ®åº“åŒé‡ä¿å­˜
- âœ… **ç›‘æ§å‘Šè­¦**ï¼šå®Œæ•´çš„æ—¥å¿—è®°å½•

## ğŸ”® æœªæ¥ä¼˜åŒ–æ–¹å‘

1. **å¤šçº¿ç¨‹çˆ¬å–**ï¼šæé«˜çˆ¬å–æ•ˆç‡
2. **ä»£ç†æ± è½®æ¢**ï¼šé¿å…IPå°ç¦
3. **æ™ºèƒ½é‡è¯•**ï¼šç½‘ç»œå¼‚å¸¸è‡ªåŠ¨é‡è¯•
4. **æ•°æ®ç›‘æ§**ï¼šå®æ—¶ç›‘æ§æ•°æ®å˜åŒ–
5. **å‘Šè­¦æœºåˆ¶**ï¼šå¼‚å¸¸æƒ…å†µåŠæ—¶é€šçŸ¥

---

**ç»“è®º**ï¼šé€šè¿‡æ·±å…¥åˆ†æç½‘ç«™çš„åçˆ¬æœºåˆ¶ï¼Œé‡‡ç”¨æ­£ç¡®çš„è¯·æ±‚æ–¹æ³•å’Œå‚æ•°ï¼ŒæˆåŠŸç»•è¿‡äº†åçˆ¬æŠ€æœ¯ï¼Œå®ç°äº†ç¨³å®šçš„æ•°æ®çˆ¬å–ã€‚å…³é”®æˆåŠŸå› ç´ æ˜¯å®Œæ•´æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨è¡Œä¸ºï¼ŒåŒ…æ‹¬æ­£ç¡®çš„è¯·æ±‚å¤´ã€è¯·æ±‚æ–¹æ³•å’Œå‚æ•°ä¼ é€’ã€‚

---

## ğŸ”„ ä¿®æ”¹å‰åå…³é”®ä»£ç å¯¹æ¯”

### 1. è¯·æ±‚å¤´ä¿®æ”¹ - å…³é”®çªç ´

**ä¿®æ”¹å‰ï¼ˆå¤±è´¥ï¼‰**ï¼š
```python
session.headers.update({
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
    'Accept': 'application/json, text/plain, */*',
    'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
    'Referer': 'https://gs.amac.org.cn/amac-infodisc/res/pof/person',  # âŒ ç¼ºå°‘userId
    'Origin': 'https://gs.amac.org.cn',
    'X-Requested-With': 'XMLHttpRequest'
})
```

**ä¿®æ”¹åï¼ˆæˆåŠŸï¼‰**ï¼š
```python
session.headers.update({
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36',
    'Accept': 'application/json, text/javascript, */*; q=0.01',  # âœ… æ›´ç²¾ç¡®çš„Accept
    'Accept-Language': 'zh-CN,zh;q=0.9',  # âœ… ç®€åŒ–è¯­è¨€è®¾ç½®
    'Content-Type': 'application/json',  # âœ… æ·»åŠ Content-Type
    'Origin': 'https://gs.amac.org.cn',
    'Referer': 'https://gs.amac.org.cn/amac-infodisc/res/pof/person/personList.html?userId=1700000000699008',  # âœ… åŒ…å«userId
    'X-Requested-With': 'XMLHttpRequest'
})
```

**å…³é”®æ”¹åŠ¨**ï¼š
- âœ… **Refereræ·»åŠ userId**ï¼š`userId=1700000000699008` æ˜¯è®¤è¯å…³é”®
- âœ… **Content-Typeè®¾ç½®**ï¼š`application/json` å¿…é¡»
- âœ… **Acceptå¤´ä¼˜åŒ–**ï¼šæ›´ç²¾ç¡®çš„MIMEç±»å‹

### 2. è¯·æ±‚æ–¹æ³•ä¿®æ”¹ - æ ¸å¿ƒçªç ´

**ä¿®æ”¹å‰ï¼ˆå¤±è´¥ï¼‰**ï¼š
```python
# å°è¯•GETè¯·æ±‚
response = session.get(
    "https://gs.amac.org.cn/amac-infodisc/api/pof/person",
    params=params,
    timeout=30
)
# ç»“æœï¼šè¿”å›500é”™è¯¯
```

**ä¿®æ”¹åï¼ˆæˆåŠŸï¼‰**ï¼š
```python
# ä½¿ç”¨POSTè¯·æ±‚
response = session.post(
    "https://gs.amac.org.cn/amac-infodisc/api/pof/person",
    params=params,
    json=json_data,  # âœ… æ·»åŠ JSONæ•°æ®
    timeout=30
)
# ç»“æœï¼šè¿”å›200æˆåŠŸ
```

**å…³é”®æ”¹åŠ¨**ï¼š
- âœ… **POSTæ–¹æ³•**ï¼šç½‘ç«™å®é™…ä½¿ç”¨POSTè·å–æ•°æ®
- âœ… **JSONæ•°æ®**ï¼šæ·»åŠ è®¤è¯å‚æ•°

### 3. å‚æ•°ä¼ é€’ä¿®æ”¹ - åˆ†é¡µæœºåˆ¶çªç ´

**ä¿®æ”¹å‰ï¼ˆå¤±è´¥ï¼‰**ï¼š
```python
# é”™è¯¯çš„JSONæ•°æ®æ ¼å¼
json_data = {
    'page': page,  # âŒ é”™è¯¯çš„pageå‚æ•°
    'size': page_size,
    'orgName': '',
    'userName': '',
    'certCode': '',
    'status': '',
    'education': '',
    'certName': ''
}
```

**ä¿®æ”¹åï¼ˆæˆåŠŸï¼‰**ï¼š
```python
# æ­£ç¡®çš„JSONæ•°æ®æ ¼å¼
json_data = {
    'userId': '1700000000699008',  # âœ… æ·»åŠ è®¤è¯userId
    'page': 1  # âœ… å›ºå®šä¸º1ï¼Œåˆ†é¡µé€šè¿‡URLå‚æ•°æ§åˆ¶
}
```

**å…³é”®æ”¹åŠ¨**ï¼š
- âœ… **æ·»åŠ userId**ï¼š`1700000000699008` æ˜¯è®¤è¯å…³é”®
- âœ… **pageå›ºå®šä¸º1**ï¼šåˆ†é¡µé€šè¿‡URLå‚æ•°æ§åˆ¶ï¼ŒJSONä¸­çš„pageå›ºå®š

### 4. åˆ†é¡µæœºåˆ¶ç†è§£ - å…³é”®å‘ç°

**ä¿®æ”¹å‰ï¼ˆé”™è¯¯ç†è§£ï¼‰**ï¼š
```python
# é”™è¯¯çš„åˆ†é¡µé€»è¾‘
params = {
    'rand': f"0.{random.randint(1000000000000000, 9999999999999999)}",
    'page': page,
    'size': page_size
}
json_data = {
    'page': page + 1  # âŒ é”™è¯¯ï¼šJSONä¸­çš„pageä¹Ÿåœ¨å˜åŒ–
}
```

**ä¿®æ”¹åï¼ˆæ­£ç¡®ç†è§£ï¼‰**ï¼š
```python
# æ­£ç¡®çš„åˆ†é¡µé€»è¾‘
params = {
    'rand': f"0.{random.randint(1000000000000000, 9999999999999999)}",
    'page': page,  # âœ… URLå‚æ•°æ§åˆ¶åˆ†é¡µ
    'size': page_size
}
json_data = {
    'userId': '1700000000699008',
    'page': 1  # âœ… JSONä¸­çš„pageå›ºå®šä¸º1
}
```

**å…³é”®å‘ç°**ï¼š
- âœ… **åˆ†é¡µæœºåˆ¶**ï¼šåˆ†é¡µé€šè¿‡URLå‚æ•°æ§åˆ¶ï¼ŒJSONä¸­çš„pageå›ºå®šä¸º1
- âœ… **è®¤è¯æœºåˆ¶**ï¼šuserIdæ˜¯è®¤è¯çš„å…³é”®å‚æ•°

### 5. æ•°æ®å­—æ®µæ·»åŠ  - çˆ¬å–æ—¶é—´

**ä¿®æ”¹å‰**ï¼š
```python
personnel_info = {
    'name': person.get('userName', ''),
    'gender': person.get('sex', ''),
    'cert_code': person.get('certCode', ''),
    'org_name': person.get('orgName', ''),
    'cert_name': person.get('certName', ''),
    'cert_obtain_date': cert_obtain_date,
    'cert_status_change_times': person.get('certStatusChangeTimes', 0),
    'credit_record_num': person.get('creditRecordNum', 0),
    'status_name': person.get('statusName', ''),
    'education_name': person.get('educationName', '')
}
```

**ä¿®æ”¹å**ï¼š
```python
personnel_info = {
    'name': person.get('userName', ''),
    'gender': person.get('sex', ''),
    'cert_code': person.get('certCode', ''),
    'org_name': person.get('orgName', ''),
    'cert_name': person.get('certName', ''),
    'cert_obtain_date': cert_obtain_date,
    'cert_status_change_times': person.get('certStatusChangeTimes', 0),
    'credit_record_num': person.get('creditRecordNum', 0),
    'status_name': person.get('statusName', ''),
    'education_name': person.get('educationName', ''),
    'crawl_time': datetime.now().strftime('%Y-%m-%d %H:%M:%S')  # âœ… æ·»åŠ çˆ¬å–æ—¶é—´
}
```

## ğŸ¯ æˆåŠŸå…³é”®æ€»ç»“

### 1. æœ€å…³é”®çš„ä¿®æ”¹
1. **Refereræ·»åŠ userId**ï¼š`userId=1700000000699008` æ˜¯è®¤è¯çš„å…³é”®
2. **POSTè¯·æ±‚æ–¹æ³•**ï¼šç½‘ç«™å®é™…ä½¿ç”¨POSTè·å–æ•°æ®
3. **JSONæ•°æ®æ ¼å¼**ï¼šæ·»åŠ userIdè®¤è¯å‚æ•°
4. **åˆ†é¡µæœºåˆ¶ç†è§£**ï¼šURLå‚æ•°æ§åˆ¶åˆ†é¡µï¼ŒJSONå›ºå®š

### 2. å¤±è´¥çš„å°è¯•
- âŒ GETè¯·æ±‚ï¼šè¿”å›500é”™è¯¯
- âŒ é”™è¯¯Refererï¼šè¿”å›ç©ºæ•°æ®
- âŒ é”™è¯¯userIdï¼šè®¤è¯å¤±è´¥
- âŒ é”™è¯¯åˆ†é¡µï¼šæ•°æ®å¼‚å¸¸

### 3. æˆåŠŸçš„è¦ç´ 
- âœ… æ­£ç¡®çš„è¯·æ±‚æ–¹æ³• (POST)
- âœ… å®Œæ•´çš„è¯·æ±‚å¤´ (åŒ…å«userIdçš„Referer)
- âœ… æ­£ç¡®çš„è®¤è¯å‚æ•° (userId)
- âœ… æ­£ç¡®çš„åˆ†é¡µæœºåˆ¶ (URLå‚æ•°æ§åˆ¶)

**ç»“è®º**ï¼šé€šè¿‡åˆ†æä½ æä¾›çš„cURLå‘½ä»¤ï¼Œå‘ç°äº†å…³é”®çš„è®¤è¯æœºåˆ¶ï¼ˆuserIdï¼‰å’Œåˆ†é¡µæœºåˆ¶ï¼ˆURLå‚æ•°æ§åˆ¶ï¼‰ï¼Œè¿™äº›ç»†èŠ‚çš„ä¿®æ”¹æ˜¯åçˆ¬ç»•è¿‡æˆåŠŸçš„å…³é”®ã€‚ 